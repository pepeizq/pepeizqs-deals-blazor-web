@page "/account/"
@page "/account/{seccion}/"

@attribute [Authorize]

@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.AspNetCore.Identity
@using global::Juegos
@using pepeizqs_deals_web.Data

@inject IHttpContextAccessor Contexto
@inject IJSRuntime JavaScript

@{
    string titulo = Herramientas.Idiomas.BuscarTexto(idioma, "Title", "Account") + " • pepeizq's deals";
}

<HeadContent>
    <PageTitle>@titulo</PageTitle>
</HeadContent>

<style>
    .boton-pestañas {
        color: var(--colorTexto);
        background-color: var(--fondoBotonPequeño);
        border: 1px solid var(--fondoOscuro);
        width: 100%;
        transition: transform .2s;
        font-size: 17px;
        padding: 15px 20px;
    }

    .boton-pestañas:hover {
        color: var(--colorTextoHover);
        transform: scale(1.01);
    }

    .grid-estructura {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
    }

    @@media (max-width: 800px) {
        .grid-estructura {
            display: grid;
            gap: 20px;
        }
    }
</style>

<style>
	.caja-cuenta-indice-contenido {
		background-color: var(--fondoSubsubcabecera);
		box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.28),0px 0px 2px 0px rgba(0, 0, 0, 0.24);
	}

    .caja-cuenta-indice-titulo {
		background: color-mix(in srgb, var(--fondoSubcabecera) 45%, var(--fondoBotonPequeño));
		font-size: 18px;
		padding: 20px 30px;
        border: 1px solid var(--fondoSubsubcabecera);
	}
</style>

<script>
    window.ChangeUrl = function (url) {
        history.pushState(null, '', url);
    }
</script>

@if (enseñarOpcion == false)
{
    <div class="subcabecera">
		<div class="cuerpo-ancho sub-subcabecera">
            <h1 style="font-size: 18px; margin: 10px 0px;">
				@Herramientas.Idiomas.BuscarTexto(idioma, "Title", "Account")
			</h1>
        </div>
    </div>

    <div class="caja-cuenta-indice-contenido cuerpo-ancho" style="margin-top: 40px; margin-bottom: 40px;">
        <div class="caja-cuenta-indice-titulo">
            @Herramientas.Idiomas.BuscarTexto(idioma, "String1", "Account")
	    </div>

        <div class="grid-estructura" style="padding: 30px;">
            <button @onclick="MostrarCorreo" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path d="M307 34.8c-11.5 5.1-19 16.6-19 29.2l0 64-112 0C78.8 128 0 206.8 0 304C0 417.3 81.5 467.9 100.2 478.1c2.5 1.4 5.3 1.9 8.1 1.9c10.9 0 19.7-8.9 19.7-19.7c0-7.5-4.3-14.4-9.8-19.5C108.8 431.9 96 414.4 96 384c0-53 43-96 96-96l96 0 0 64c0 12.6 7.4 24.1 19 29.2s25 3 34.4-5.4l160-144c6.7-6.1 10.6-14.7 10.6-23.8s-3.8-17.7-10.6-23.8l-160-144c-9.4-8.5-22.9-10.6-34.4-5.4z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String2", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String17", "Account")
                        </div>
                    </div>
                </div>
            </button>

            <button @onclick="MostrarContraseña" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                            <path d="M144 144c0-44.2 35.8-80 80-80c31.9 0 59.4 18.6 72.3 45.7c7.6 16 26.7 22.8 42.6 15.2s22.8-26.7 15.2-42.6C331 33.7 281.5 0 224 0C144.5 0 80 64.5 80 144l0 48-16 0c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-192c0-35.3-28.7-64-64-64l-240 0 0-48z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String4", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String16", "Account")
                        </div>
                    </div>
                </div>
            </button>

            <button @onclick="MostrarDatosPersonales" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 242.7-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7 288 32zM64 352c-35.3 0-64 28.7-64 64l0 32c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-32c0-35.3-28.7-64-64-64l-101.5 0-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352 64 352zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String7", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String15", "Account")
                        </div>
                    </div>
                </div>
            </button>

            <button @onclick="MostrarIdioma" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path d="M266.3 48.3L232.5 73.6c-5.4 4-8.5 10.4-8.5 17.1l0 9.1c0 6.8 5.5 12.3 12.3 12.3c2.4 0 4.8-.7 6.8-2.1l41.8-27.9c2-1.3 4.4-2.1 6.8-2.1l1 0c6.2 0 11.3 5.1 11.3 11.3c0 3-1.2 5.9-3.3 8l-19.9 19.9c-5.8 5.8-12.9 10.2-20.7 12.8l-26.5 8.8c-5.8 1.9-9.6 7.3-9.6 13.4c0 3.7-1.5 7.3-4.1 10l-17.9 17.9c-6.4 6.4-9.9 15-9.9 24l0 4.3c0 16.4 13.6 29.7 29.9 29.7c11 0 21.2-6.2 26.1-16l4-8.1c2.4-4.8 7.4-7.9 12.8-7.9c4.5 0 8.7 2.1 11.4 5.7l16.3 21.7c2.1 2.9 5.5 4.5 9.1 4.5c8.4 0 13.9-8.9 10.1-16.4l-1.1-2.3c-3.5-7 0-15.5 7.5-18l21.2-7.1c7.6-2.5 12.7-9.6 12.7-17.6c0-10.3 8.3-18.6 18.6-18.6l29.4 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-20.7 0c-7.2 0-14.2 2.9-19.3 8l-4.7 4.7c-2.1 2.1-3.3 5-3.3 8c0 6.2 5.1 11.3 11.3 11.3l11.3 0c6 0 11.8 2.4 16 6.6l6.5 6.5c1.8 1.8 2.8 4.3 2.8 6.8s-1 5-2.8 6.8l-7.5 7.5C386 262 384 266.9 384 272s2 10 5.7 13.7L408 304c10.2 10.2 24.1 16 38.6 16l7.3 0c6.5-20.2 10-41.7 10-64c0-111.4-87.6-202.4-197.7-207.7zm172 307.9c-3.7-2.6-8.2-4.1-13-4.1c-6 0-11.8-2.4-16-6.6L396 332c-7.7-7.7-18-12-28.9-12c-9.7 0-19.2-3.5-26.6-9.8L314 287.4c-11.6-9.9-26.4-15.4-41.7-15.4l-20.9 0c-12.6 0-25 3.7-35.5 10.7L188.5 301c-17.8 11.9-28.5 31.9-28.5 53.3l0 3.2c0 17 6.7 33.3 18.7 45.3l16 16c8.5 8.5 20 13.3 32 13.3l21.3 0c13.3 0 24 10.7 24 24c0 2.5 .4 5 1.1 7.3c71.3-5.8 132.5-47.6 165.2-107.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM187.3 100.7c-6.2-6.2-16.4-6.2-22.6 0l-32 32c-6.2 6.2-6.2 16.4 0 22.6s16.4 6.2 22.6 0l32-32c6.2-6.2 6.2-16.4 0-22.6z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String24", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String25", "Account")
                        </div>
                    </div>
                </div>
            </button>

            <button @onclick="MostrarClaves" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path d="M336 352c97.2 0 176-78.8 176-176S433.2 0 336 0S160 78.8 160 176c0 18.7 2.9 36.8 8.3 53.7L7 391c-4.5 4.5-7 10.6-7 17l0 80c0 13.3 10.7 24 24 24l80 0c13.3 0 24-10.7 24-24l0-40 40 0c13.3 0 24-10.7 24-24l0-40 40 0c6.4 0 12.5-2.5 17-7l33.3-33.3c16.9 5.4 35 8.3 53.7 8.3zM376 96a40 40 0 1 1 0 80 40 40 0 1 1 0-80z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String6", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String12", "Account")
                        </div>
                    </div>
                </div>
            </button>

            <button @onclick="MostrarNotificacionesCorreo" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                            <path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String3", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String14", "Account")
                        </div>
                    </div>
                </div>
            </button>

            <button @onclick="MostrarJuegos" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                            <path d="M448 128C554 128 640 214 640 320C640 426 554 512 448 512L192 512C86 512 0 426 0 320C0 214 86 128 192 128L448 128zM192 240C178.7 240 168 250.7 168 264L168 296L136 296C122.7 296 112 306.7 112 320C112 333.3 122.7 344 136 344L168 344L168 376C168 389.3 178.7 400 192 400C205.3 400 216 389.3 216 376L216 344L248 344C261.3 344 272 333.3 272 320C272 306.7 261.3 296 248 296L216 296L216 264C216 250.7 205.3 240 192 240zM432 336C414.3 336 400 350.3 400 368C400 385.7 414.3 400 432 400C449.7 400 464 385.7 464 368C464 350.3 449.7 336 432 336zM496 240C478.3 240 464 254.3 464 272C464 289.7 478.3 304 496 304C513.7 304 528 289.7 528 272C528 254.3 513.7 240 496 240z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String35", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String36", "Account")
                        </div>
                    </div>
                </div>
            </button>

            <button @onclick="MostrarPerfil" class="boton-pestañas">
                <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                    <div style="max-width: 22px;">
                        <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                            <path d="M320 312C386.3 312 440 258.3 440 192C440 125.7 386.3 72 320 72C253.7 72 200 125.7 200 192C200 258.3 253.7 312 320 312zM290.3 368C191.8 368 112 447.8 112 546.3C112 562.7 125.3 576 141.7 576L498.3 576C514.7 576 528 562.7 528 546.3C528 447.8 448.2 368 349.7 368L290.3 368z" />
                        </svg>
                    </div>

                    <div>
                        <div>
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String33", "Account")
                        </div>

                        <div style="margin-top: 5px; font-size: 14px;">
                            @Herramientas.Idiomas.BuscarTexto(idioma, "String34", "Account")
                        </div>
                    </div>
                </div>
            </button>
        </div>
    </div>

    @if (opcionesCuenta.EmailConfirmed == true)
    {
        int? monedas = 0;

        if (opcionesCuenta.PatreonCoins != null)
        {
            monedas = opcionesCuenta.PatreonCoins;
        }

        <div class="caja-cuenta-indice-contenido cuerpo-ancho" style="margin-top: 40px; margin-bottom: 40px;">
            <div class="caja-cuenta-indice-titulo">
                @Herramientas.Idiomas.BuscarTexto(idioma, "String28", "Account") (@monedas)
            </div>

            <div class="grid-estructura" style="padding: 30px;">
                <button @onclick="MostrarTienda" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <div style="max-width: 22px;">
                            <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                                <path d="M547.6 103.8L490.3 13.1C485.2 5 476.1 0 466.4 0L109.6 0C99.9 0 90.8 5 85.7 13.1L28.3 103.8c-29.6 46.8-3.4 111.9 51.9 119.4c4 .5 8.1 .8 12.1 .8c26.1 0 49.3-11.4 65.2-29c15.9 17.6 39.1 29 65.2 29c26.1 0 49.3-11.4 65.2-29c15.9 17.6 39.1 29 65.2 29c26.2 0 49.3-11.4 65.2-29c16 17.6 39.1 29 65.2 29c4.1 0 8.1-.3 12.1-.8c55.5-7.4 81.8-72.5 52.1-119.4zM499.7 254.9c0 0 0 0-.1 0c-5.3 .7-10.7 1.1-16.2 1.1c-12.4 0-24.3-1.9-35.4-5.3L448 384l-320 0 0-133.4c-11.2 3.5-23.2 5.4-35.6 5.4c-5.5 0-11-.4-16.3-1.1l-.1 0c-4.1-.6-8.1-1.3-12-2.3L64 384l0 64c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-64 0-131.4c-4 1-8 1.8-12.3 2.3z" />
                            </svg>
                        </div>

                        <div>
                            <div>
                                @Herramientas.Idiomas.BuscarTexto(idioma, "String29", "Account")
                            </div>

                            <div style="margin-top: 5px; font-size: 14px;">
                                @Herramientas.Idiomas.BuscarTexto(idioma, "String30", "Account")
                            </div>
                        </div>
                    </div>
                </button>

                <button @onclick="MostrarHistorial" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <div style="max-width: 22px;">
                            <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                <path d="M512 80c0 18-14.3 34.6-38.4 48c-29.1 16.1-72.5 27.5-122.3 30.9c-3.7-1.8-7.4-3.5-11.3-5C300.6 137.4 248.2 128 192 128c-8.3 0-16.4 .2-24.5 .6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80S512 35.8 512 80zM160.7 161.1c10.2-.7 20.7-1.1 31.3-1.1c62.2 0 117.4 12.3 152.5 31.4C369.3 204.9 384 221.7 384 240c0 4-.7 7.9-2.1 11.7c-4.6 13.2-17 25.3-35 35.5c0 0 0 0 0 0c-.1 .1-.3 .1-.4 .2c0 0 0 0 0 0s0 0 0 0c-.3 .2-.6 .3-.9 .5c-35 19.4-90.8 32-153.6 32c-59.6 0-112.9-11.3-148.2-29.1c-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4c10.5-1.5 21.4-2.7 32.7-3.5zM416 240c0-21.9-10.6-39.9-24.1-53.4c28.3-4.4 54.2-11.4 76.2-20.5c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 19.3-16.5 37.1-43.8 50.9c-14.6 7.4-32.4 13.7-52.4 18.5c.1-1.8 .2-3.5 .2-5.3zm-32 96c0 18-14.3 34.6-38.4 48c-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9c6.1-3.4 11.8-7.2 17.2-11.2c1.5-1.1 2.9-2.3 4.3-3.4l0 3.4 0 5.7 0 26.3zm32 0l0-32 0-25.9c19-4.2 36.5-9.5 52.1-16c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 10.5-5 21-14.9 30.9c-16.3 16.3-45 29.7-81.3 38.4c.1-1.7 .2-3.5 .2-5.3zM192 448c56.2 0 108.6-9.4 148.1-25.9c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 44.2-86 80-192 80S0 476.2 0 432l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 438.6 135.8 448 192 448z" />
                            </svg>
                        </div>

                        <div>
                            <div>
                                @Herramientas.Idiomas.BuscarTexto(idioma, "String31", "Account")
                            </div>

                            <div style="margin-top: 5px; font-size: 14px;">
                                @Herramientas.Idiomas.BuscarTexto(idioma, "String32", "Account")
                            </div>
                        </div>
                    </div>
                </button>

                <button @onclick="MostrarPatreon" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <div style="max-width: 22px;">
                            <svg class="svg-boton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                <path d="M489.7 153.8c-.1-65.4-51-119-110.7-138.3C304.8-8.5 207-5 136.1 28.4C50.3 68.9 23.3 157.7 22.3 246.2C21.5 319 28.7 510.6 136.9 512c80.3 1 92.3-102.5 129.5-152.3c26.4-35.5 60.5-45.5 102.4-55.9c72-17.8 121.1-74.7 121-150z" />
                            </svg>
                        </div>

                        <div>
                            <div>
                                @Herramientas.Idiomas.BuscarTexto(idioma, "String8", "Account")
                            </div>

                            <div style="margin-top: 5px; font-size: 14px;">
                                @Herramientas.Idiomas.BuscarTexto(idioma, "String13", "Account")
                            </div>
                        </div>
                    </div>
                </button>
            </div>
        </div>

        <div class="caja-cuenta-indice-contenido cuerpo-ancho" style="margin-top: 40px; margin-bottom: 40px;">
            <div class="caja-cuenta-indice-titulo">
                @Herramientas.Idiomas.BuscarTexto(idioma, "String18", "Account")
            </div>

            <div class="grid-estructura" style="padding: 30px;">
                <button @onclick="MostrarSteam" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(JuegoDRM2.SacarImagen(JuegoDRM.Steam))" style="max-width: 30px; max-height: 30px;" />

                        <div style="display: flex; flex-direction: column; gap: 5px;">
                            <div>
                                @JuegoDRM2.DevolverDRM(JuegoDRM.Steam)
                            </div>

                            @if (string.IsNullOrEmpty(opcionesCuenta.SteamAccountLastCheck) == false)
                            {
                                <div style="font-size: 14px;">
                                    @Herramientas.Idiomas.BuscarTexto(idioma, "String10", "Account") @Herramientas.Calculadora.DiferenciaTiempo(Convert.ToDateTime(opcionesCuenta.SteamAccountLastCheck), idioma)
                                </div>
                            }
                        </div>
                    </div>
                </button>

                <button @onclick="MostrarGog" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(JuegoDRM2.SacarImagen(JuegoDRM.GOG))" style="max-width: 30px; max-height: 30px;" />

                        <div style="display: flex; flex-direction: column; gap: 5px;">
                            <div>
                                @JuegoDRM2.DevolverDRM(JuegoDRM.GOG)
                            </div>

                            @if (opcionesCuenta.GogAccountLastCheck != null)
                            {
                                <div style="font-size: 14px;">
                                    @Herramientas.Idiomas.BuscarTexto(idioma, "String10", "Account") @Herramientas.Calculadora.DiferenciaTiempo(opcionesCuenta.GogAccountLastCheck, idioma)
                                </div>
                            }
                        </div>
                    </div>
                </button>

                <button @onclick="MostrarAmazon" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(JuegoDRM2.SacarImagen(JuegoDRM.Amazon))" style="max-width: 30px; max-height: 30px;" />

                        <div style="display: flex; flex-direction: column; gap: 5px;">
                            <div>
                                @JuegoDRM2.DevolverDRM(JuegoDRM.Amazon)
                            </div>

                            @if (opcionesCuenta.AmazonLastImport != null)
                            {
                                <div style="font-size: 14px;">
                                    @Herramientas.Idiomas.BuscarTexto(idioma, "String9", "Account") @Herramientas.Calculadora.DiferenciaTiempo(opcionesCuenta.AmazonLastImport, idioma)
                                </div>
                            }
                        </div>
                    </div>
                </button>

                <button @onclick="MostrarEpicGames" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(JuegoDRM2.SacarImagen(JuegoDRM.Epic))" style="max-width: 30px; max-height: 30px;" />

                        <div style="display: flex; flex-direction: column; gap: 5px;">
                            <div>
                                @JuegoDRM2.DevolverDRM(JuegoDRM.Epic)
                            </div>

                            @if (opcionesCuenta.EpicGamesLastImport != null)
                            {
                                <div style="font-size: 14px;">
                                    @Herramientas.Idiomas.BuscarTexto(idioma, "String9", "Account") @Herramientas.Calculadora.DiferenciaTiempo(opcionesCuenta.EpicGamesLastImport, idioma)
                                </div>
                            }
                        </div>
                    </div>
                </button>

                <button @onclick="MostrarUbisoft" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(JuegoDRM2.SacarImagen(JuegoDRM.Ubisoft))" style="max-width: 30px; max-height: 30px;" />

                        <div style="display: flex; flex-direction: column; gap: 5px;">
                            <div>
                                @JuegoDRM2.DevolverDRM(JuegoDRM.Ubisoft)
                            </div>

                            @if (opcionesCuenta.UbisoftLastImport != null)
                            {
                                <div style="font-size: 14px;">
                                    @Herramientas.Idiomas.BuscarTexto(idioma, "String9", "Account") @Herramientas.Calculadora.DiferenciaTiempo(opcionesCuenta.UbisoftLastImport, idioma)
                                </div>
                            }
                        </div>
                    </div>
                </button>

                <button @onclick="MostrarEa" class="boton-pestañas">
                    <div style="display: flex; align-items: center; gap: 20px; text-align: left;">
                        <img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(JuegoDRM2.SacarImagen(JuegoDRM.EA))" style="max-width: 30px; max-height: 30px;" />

                        <div style="display: flex; flex-direction: column; gap: 5px;">
                            <div>
                                @JuegoDRM2.DevolverDRM(JuegoDRM.EA)
                            </div>

                            @if (opcionesCuenta.EaLastImport != null)
                            {
                                <div style="font-size: 14px;">
                                    @Herramientas.Idiomas.BuscarTexto(idioma, "String9", "Account") @Herramientas.Calculadora.DiferenciaTiempo(opcionesCuenta.EaLastImport, idioma)
                                </div>
                            }
                        </div>
                    </div>
                </button>
            </div>
        </div>
    }
    else
    {
        <div style="margin: 40px auto; background-color: var(--fondoPeligro); padding: 15px 20px;">
            @Herramientas.Idiomas.BuscarTexto(idioma, "String11", "Account")
        </div>
    }
}
else
{
    <div class="subcabecera">
        <div class="cuerpo-ancho sub-subcabecera" style="padding: 17px 0px;">
            <button @onclick="ClickearCerrarPestaña" class="boton-pequeño" style="width: fit-content; padding: 8px 20px 8px 0px; background-color: transparent;">
                <h1 style="font-size: 18px; margin: 0px;">
                    @Herramientas.Idiomas.BuscarTexto(idioma, "Title", "Account")
                </h1>
            </button>

            <div style="width: fit-content; padding: 8px 20px; border-radius: 5px; background-color: var(--botonSubcabecera); box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.25),0px 0px 1px 0px rgba(0, 0, 0, 0.25);">
                <h1 style="font-size: 18px; margin: 0px;">
                    @tituloOpcion
                </h1>
            </div>
        </div>
    </div>

    <div class="cuerpo-ancho" style="width: 100%; @añadirMargin">
        @if (mostrarCorreo == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.Correo idioma="@idioma" />
        }

        @if (mostrarContraseña == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.CambioContrasena idioma="@idioma" />
        }

        @if (mostrarDatosPersonales == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.DatosPersonales idioma="@idioma" />
        }

        @if (mostrarIdioma == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.Idioma idioma="@idioma" />
        }

        @if (mostrarClaves == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.Claves idioma="@idioma" usuarioId="@usuarioId" />
        }

        @if (mostrarForo == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.Foro idioma="@idioma" />
        }

        @if (mostrarTienda == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Pepecoins.Tienda idioma="@idioma" usuarioId="@usuarioId" usuarioAdmin="@usuarioAdmin"/>
        }

        @if (mostrarHistorial == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Pepecoins.Historial idioma="@idioma" usuarioId="@usuarioId" />
        }

        @if (mostrarPatreon == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Pepecoins.Patreon idioma="@idioma" />
        }

        @if (mostrarJuegos == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.Juegos idioma="@idioma" usuarioId="@usuarioId" fondoCabecera="background-color: var(--fondoSubsubcabecera);" />
        }

        @if (mostrarPerfil == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Cuenta.Perfil idioma="@idioma" />
        }

        @if (mostrarNotificacionesCorreo == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Notificaciones.Correo idioma="@idioma" />
        }

        @if (mostrarNotificacionesPush == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Notificaciones.Push idioma="@idioma" userAgent="@userAgent" />
        }

        @if (mostrarSteam == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Juegos.Steam idioma="@idioma" />
        }

        @if (mostrarGog == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Juegos.Gog idioma="@idioma" />
        }

        @if (mostrarAmazon == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Juegos.Amazon idioma="@idioma" />
        }

        @if (mostrarEpicGames == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Juegos.EpicGames idioma="@idioma" />
        }

        @if (mostrarUbisoft == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Juegos.Ubisoft idioma="@idioma" />
        }

        @if (mostrarEa == true)
        {
            <pepeizqs_deals_blazor_web.Componentes.Cuenta.Juegos.Ea idioma="@idioma" />
        }
    </div>
}

@code {

    #nullable disable

    private string idioma = "en";
    private string usuarioId = null;
    private string userAgent = null;
    private bool usuarioPatreon = false;
    private bool usuarioAdmin = false;

    [Parameter]
    public string seccion { get; set; }

    private Usuario opcionesCuenta = null;

    private bool enseñarOpcion = false;
    private string tituloOpcion = string.Empty;
    private string añadirMargin = string.Empty;

    protected override void OnInitialized()
    {
        Herramientas.ContextoUsuarioDatos datos = Herramientas.ContextoUsuario.Leer(Contexto);
        idioma = datos.Idioma;
        usuarioId = datos.UsuarioId;
        userAgent = datos.UserAgent;

        if (string.IsNullOrEmpty(usuarioId) == false)
        {
            idioma = BaseDatos.Usuarios.Buscar.IdiomaSobreescribir(usuarioId);
            opcionesCuenta = BaseDatos.Usuarios.Buscar.OpcionesCuenta(usuarioId);
            usuarioPatreon = Herramientas.Patreon.VerificarActivo(BaseDatos.Usuarios.Buscar.FechaPatreon(usuarioId));
            usuarioAdmin = BaseDatos.Usuarios.Buscar.RolDios(usuarioId);

            if (string.IsNullOrEmpty(seccion) == false)
            {
                if (seccion == "email")
                {
                    MostrarJuegos();
                }

                if (seccion == "password")
                {
                    MostrarContraseña();
                }

                if (seccion == "data")
                {
                    MostrarDatosPersonales();
                }

                if (seccion == "language")
                {
                    MostrarIdioma();
                }

                if (seccion == "keys")
                {
                    MostrarClaves();
                }

                if (seccion == "forum")
                {
                    MostrarForo();
                }

                if (seccion == "games")
                {
                    MostrarJuegos();
                }

                if (seccion == "profile")
                {
                    MostrarPerfil();
                }

                if (seccion == "store")
                {
                    MostrarTienda();
                }

                if (seccion == "record")
                {
                    MostrarHistorial();
                }

                if (seccion == "patreon")
                {
                    MostrarPatreon();
                }

                if (seccion == "notificationsemail")
                {
                    MostrarNotificacionesCorreo();
                }

                if (seccion == "notificationspush")
                {
                    MostrarNotificacionesPush();
                }

                if (seccion == "steam")
                {
                    MostrarSteam();
                }

                if (seccion == "gog")
                {
                    MostrarGog();
                }

                if (seccion == "amazon")
                {
                    MostrarAmazon();
                }

                if (seccion == "epicgames")
                {
                    MostrarEpicGames();
                }

                if (seccion == "ubisoft")
                {
                    MostrarUbisoft();
                }

                if (seccion == "ea")
                {
                    MostrarEa();
                }
            }
        }
    }

    private void CerrarPestañas()
    {
        tituloOpcion = string.Empty;
        añadirMargin = string.Empty;

        mostrarCorreo = false;
        mostrarContraseña = false;
        mostrarDatosPersonales = false;
        mostrarIdioma = false;
        mostrarClaves = false;
        mostrarForo = false;
        mostrarJuegos = false;
        mostrarPerfil = false;

        mostrarTienda = false;
        mostrarHistorial = false;
        mostrarPatreon = false;

        mostrarNotificacionesCorreo = false;
        mostrarNotificacionesPush = false;

        mostrarSteam = false;
        mostrarGog = false;
        mostrarAmazon = false;
        mostrarEpicGames = false;
        mostrarUbisoft = false;
        mostrarEa = false;
    }

    private async void ClickearCerrarPestaña()
    {
        tituloOpcion = string.Empty;
        enseñarOpcion = false;

        seccion = string.Empty;
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/");
    }

    #region Cuenta

    private bool mostrarCorreo = false;

    private async void MostrarCorreo()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String2", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarCorreo = true;
        seccion = "email";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarContraseña = false;

    private async void MostrarContraseña()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String4", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarContraseña = true;
        seccion = "password";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarDatosPersonales = false;

    private async void MostrarDatosPersonales()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String7", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarDatosPersonales = true;
        seccion = "data";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarIdioma = false;

    private async void MostrarIdioma()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String24", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarIdioma = true;
        seccion = "language";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarClaves = false;

    private async void MostrarClaves()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String6", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarClaves = true;
        seccion = "keys";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarForo = false;

    private async void MostrarForo()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String26", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarForo = true;
        seccion = "forum";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarJuegos = false;

    private async void MostrarJuegos()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String35", "Account");
        añadirMargin = string.Empty;
        enseñarOpcion = true;
        mostrarJuegos = true;
        seccion = "games";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarPerfil = false;

    private async void MostrarPerfil()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String33", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarPerfil = true;
        seccion = "profile";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    #endregion

    #region Pepecoins

    private bool mostrarTienda = false;

    private async void MostrarTienda()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String29", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarTienda = true;
        seccion = "store";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarHistorial = false;

    private async void MostrarHistorial()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String31", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarHistorial = true;
        seccion = "record";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }
    
    private bool mostrarPatreon = false;

    private async void MostrarPatreon()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String8", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarPatreon = true;
        seccion = "patreon";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    #endregion

    #region Notificaciones

    private bool mostrarNotificacionesCorreo = false;

    private async void MostrarNotificacionesCorreo()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String3", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarNotificacionesCorreo = true;
        seccion = "notificationsemail";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarNotificacionesPush = false;

    private async void MostrarNotificacionesPush()
    {
        CerrarPestañas();
        tituloOpcion = Herramientas.Idiomas.BuscarTexto(idioma, "String21", "Account");
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarNotificacionesPush = true;
        seccion = "notificationspush";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    #endregion

    #region Juegos

    private bool mostrarSteam = false;

    private async void MostrarSteam()
    {
        CerrarPestañas();
        tituloOpcion = JuegoDRM2.DevolverDRM(JuegoDRM.Steam);
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarSteam = true;
        seccion = "steam";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarGog = false;

    private async void MostrarGog()
    {
        CerrarPestañas();
        tituloOpcion = JuegoDRM2.DevolverDRM(JuegoDRM.GOG);
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarGog = true;
        seccion = "gog";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarAmazon = false;

    private async void MostrarAmazon()
    {
        CerrarPestañas();
        tituloOpcion = JuegoDRM2.DevolverDRM(JuegoDRM.Amazon);
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarAmazon = true;
        seccion = "amazon";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarEpicGames = false;

    private async void MostrarEpicGames()
    {
        CerrarPestañas();
        tituloOpcion = JuegoDRM2.DevolverDRM(JuegoDRM.Epic);
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarEpicGames = true;
        seccion = "epicgames";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarUbisoft = false;

    private async void MostrarUbisoft()
    {
        CerrarPestañas();
        tituloOpcion = JuegoDRM2.DevolverDRM(JuegoDRM.Ubisoft);
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarUbisoft = true;
        seccion = "ubisoft";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    private bool mostrarEa = false;

    private async void MostrarEa()
    {
        CerrarPestañas();
        tituloOpcion = JuegoDRM2.DevolverDRM(JuegoDRM.EA);
        añadirMargin = "margin: 40px auto;";
        enseñarOpcion = true;
        mostrarEa = true;
        seccion = "ea";
        await JavaScript.InvokeVoidAsync("ChangeUrl", "/account/" + seccion + "/");
    }

    #endregion
}
